<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<style>
  h1 {text-align: center;}
  p {text-align: center;}
@media all {
    /* sets the base font size for all user agents that support media queries */
    html {
        font-size: 18px;
    }
}
@media screen and (min-width: 480px) {
    /* sets a larger base font size for viewports with a minimum with of 480px, e.g. tablets, desktops, jumbotrons, etc. */
    html {
        font-size: 24px;
    }
}
</style>

  <body>
    <h1 style="color:white;">Test Page</h1>
    </header>
  <div> Test Test Test </div>
<canvas id="myChart" width="800" height="400"></canvas>

	<h2>Input Data Config</h2>

<form id="frm1">
  Auth Token: <input type="text" id='auth' name="auth" ><br>
  Request URL: <input type="text" id='request' name="request" ><br><br>
</form> 
<button onclick="myFunction()">Try it</button>

<script>
async function fetchJSON(url, headers) {
  //await keyword - call this function and expect a promise in return. Fetch returns a promise object that contains methods
  //from the Response object (delegates, in Class terms, it's a constructor)
    let response = await fetch(url,
      {
      headers: headers
      });
  //data = the result of the fetch() function, which here I've called 'response' and is
  // a promise with some special methods for reading it from the Response object like .json() or .text()
    let data = await response.json();
    return data
}

async function myFunction() {
var auth = document.getElementById('auth').value;
var request = document.getElementById('request').value;

var my_headers = {
'authorization': auth,
'content-type': `application/json`
}

var data_obj = {
  changeData: function changeData(data){
    this.my_data = data
  },
  my_data: {
  }
}

fetchJSON(request, my_headers)
    .then((data) => {
    //  console.log(data)
      data_obj.changeData(data) //call some data-container object with a handler method for updating it's data object
    })
	console.log(data)
const final_obj = JSON.parse(data);
	console.log(final_obj)
	
    .catch((err) => {
      console.log("rejected", err);
    });
}
</script>
	<div> TEST TEST </div>
  </body>
</html>
